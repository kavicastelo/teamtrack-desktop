<div class="profile" [class.loading]="loading">

  <div class="top">
    <img class="avatar" [src]="user.avatar_url || 'assets/default-avatar.svg'" alt="avatar" />
    <div class="info">
      <h2>{{ user.full_name }}</h2>
      <p class="role">{{ user.role || 'Member' }}</p>
    </div>
  </div>

  <section class="status">
    <h3>Calendar Sync</h3>

    <div class="status-line">
      <span class="dot" [class.on]="calendarStatus?.connected"></span>
      <span class="label">
        Google: {{ calendarStatus?.connected ? 'CONNECTED' : 'NOT CONNECTED' }}
      </span>
    </div>

    <div class="actions" *ngIf="isSelf">
      <button (click)="connect()" *ngIf="!calendarStatus?.connected">
        Connect Google
      </button>

      <button (click)="syncNow()" [disabled]="syncing" *ngIf="calendarStatus?.connected">
        {{ syncing ? 'Syncing...' : 'Sync Now' }}
      </button>

      <button class="danger" (click)="disconnect()" *ngIf="calendarStatus?.connected">
        Disconnect
      </button>
    </div>
  </section>

  <section class="timeline">
    <h3>Availability (Next 7 Days)</h3>
    <div class="bars">
      <div
        *ngFor="let d of getTimelineDays()"
        class="bar"
        [class.busy]="d.busy"
        [title]="d.date | date:'EEE dd'"
      ></div>
    </div>
  </section>

  <section class="upcoming">
    <h3>Upcoming Blocks</h3>
    <div *ngFor="let ev of upcoming" class="event">
      <strong>{{ ev.summary || '(No title)' }}</strong>
      <span>{{ ev.start | date:'EEE HH:mm' }} â†’ {{ ev.end | date:'HH:mm' }}</span>
    </div>
  </section>
</div>
