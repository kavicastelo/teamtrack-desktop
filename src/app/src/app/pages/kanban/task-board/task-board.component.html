<div class="task-board" [class.dark-mode]="darkMode">
  <div class="header">
    <div class="left">
      <button (click)="refresh()" mat-stroked-button color="accent">Refresh</button>
    </div>
    <div class="right">
      <input
        #newTitle
        placeholder="Quick add (press Enter)"
        (keydown.enter)="createQuickTask(newTitle)"
      />
    </div>
  </div>

  <div *ngIf="loading" class="loading">Loadingâ€¦</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div class="columns" cdkDropListGroup>
    <div *ngFor="let col of columns" class="column">
      <div class="column-header">
        <h3>{{ col.title }}</h3>
        <span class="count">{{ col.tasks.length }}</span>
      </div>

      <div
        cdkDropList
        [id]="col.id"
        [cdkDropListData]="col.tasks"
        class="task-list"
        [ngClass]="col.id"
        (cdkDropListDropped)="drop($event)">

        <div *ngFor="let t of col.tasks" cdkDrag class="task-card" (click)="openTaskDetail(t)">
          <div class="title">{{ t.title }}</div>
          <div class="meta">
            <small *ngIf="t.assignee">ðŸ‘¤ {{ loadAssignee(t.assignee) }}</small>
            <small>{{ formatDate(t.updated_at) }}</small>
          </div>
        </div>

        <div *ngIf="col.tasks.length === 0" class="empty">No tasks</div>
      </div>
    </div>
  </div>
</div>
